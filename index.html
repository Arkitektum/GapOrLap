<!doctype html>
<html>
<head>
	<title>Gap or Lap?</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="app.css">
	<script src="https://unpkg.com/vue"></script>
</head>
<body>
	<h1>Gap or Lap?</h1>
	<div id="app">
		<textarea class="input" v-model="input"></textarea>
		<div class="timeline">
			<timespan
			v-for="timespan in getTimespans()"
			v-bind:timespan="timespan"
			v-bind:key="timespan.id"
			class="timespan">
		</timespan>
	</div>
</div>
<script>

	function getTimespanObjects(input) {

		const regex = /\(([0-9]|0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]) - ([0-9]|0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])\)/g;
		let m;
		var timespanObjects = [];
		var groupCount = 0;
		
		while ((m = regex.exec(input)) !== null) {

			if (m.index === regex.lastIndex)
				regex.lastIndex++;

			groupCount ++;
			var startHours;
			var startMinutes;
			var endHours;
			var endMinutes;

			m.forEach((match, groupIndex) => {

				if(groupIndex == 1)
					startHours = match;

				if(groupIndex == 2)
					startMinutes = match;

				if(groupIndex == 3)
					endHours = match;

				if(groupIndex == 4) {

					endMinutes = match;

					var timespanObject = {
						"id": groupCount,
						"start": new Date(null, null, null, startHours, startMinutes),
						"end": new Date(null, null, null, endHours, endMinutes),
					};

					timespanObjects.push(timespanObject);
				}

				console.log(`Found match, group ${groupIndex}: ${match}`);
			});
		};

		return timespanObjects;
	}

	var testInput = "(08:00 - 11:30) (12:00 - 14:00) (15:00 - 16:00)\n(14:00 - 15:00)";


	Vue.component('timespan', {
		props: ['timespan'],
		template: '<p>{{ timespan.start.toLocaleTimeString() }} - {{ timespan.end.toLocaleTimeString() }}</p>'
	});

	var app = new Vue({
		el: '#app',
		data: {
			input: testInput
		},
		methods: {
			getTimespans: function() {

				var timespanObjects = getTimespanObjects(this.input);

					// Convert ...

					
					return timespanObjects;
				}
			}
		});

	</script>
</body>
</html>
